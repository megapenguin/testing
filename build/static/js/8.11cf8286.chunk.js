(this["webpackJsonpretrack-admin"]=this["webpackJsonpretrack-admin"]||[]).push([[8],{471:function(e,a,t){"use strict";t.r(a);t(410);var n=t(408),c=(t(404),t(405)),i=(t(123),t(58)),r=t(5),o=(t(125),t(44)),s=(t(400),t(401)),l=t(37),j=(t(124),t(60)),b=t(100),d=t(0),u=t(88),O=t.n(u),f=t(406),p=t.n(f),h=t(407),m=t.n(h),g=(t(146),t(104)),y=(t(209),t(145)),x=(t(99),t(64)),v=(t(398),t(399)),C=t(403);var I=function(e){var a=Object(d.useState)(!1),t=Object(b.a)(a,2),n=t[0],c=t[1],l=Object(d.useState)(!1),j=Object(b.a)(l,2),u=j[0],f=j[1],p=Object(d.useState)(!1),h=Object(b.a)(p,2),m=h[0],I=h[1],S=Object(d.useState)([]),N=Object(b.a)(S,2),k=N[0],J=N[1],w=Object(d.useState)([]),P=Object(b.a)(w,2),_=P[0],B=P[1],F=Object(d.useState)([]),A=Object(b.a)(F,2),D=(A[0],A[1]);return Object(r.jsxs)("div",{children:[Object(r.jsx)(s.b,{children:Object(r.jsx)(x.a,{type:"primary",onClick:function(){c(!0),O.a.get("/api/v1/images/").then((function(a){var t=Object(C.a)(_);t=t.find((function(a){return a.imageOwnerId===e.info.id&&3===a.imageReferenceId})),D(t.imagePath)})).catch((function(e){return console.log(e)}))},children:"View"})}),Object(r.jsxs)(v.a,{title:"Jeepney Information",visible:n,confirmLoading:u,onOk:function(){e.passedData(e.info),f(!0),I(!1),setTimeout((function(){c(!1),f(!1)}),2e3)},onCancel:function(){I(!0),c(!1)},afterClose:function(){m||e.afterClosing()},footer:[Object(r.jsx)(x.a,{loading:u,onClick:function(){return a=e.info.id,f(!0),I(!1),setTimeout((function(){c(!1),f(!1)}),2e3),O.a.delete("/api/v1/images/delete_image",{params:{id:a,referenceId:3}}).then((function(e){var t=Object(C.a)(_);t=t.filter((function(e){return e.imageOwnerId!==a&&3===e.imageReferenceId})),B(t),console.log(t)})).catch((function(e){return console.log(e)})),void O.a.delete("/api/v1/jeepneys/delete_jeep",{params:{id:a}}).then((function(e){var t=Object(C.a)(k);t=t.filter((function(e){return e.id!==a})),J(t),console.log(t),v.a.success({content:"Jeepney has been Removed"})})).catch((function(e){return console.log(e)}));var a},danger:!0,children:"Remove"})],children:[Object(r.jsxs)("p",{children:[Object(r.jsx)("h3",{children:"Barangay Id:"}),e.info.barangayId]}),Object(r.jsxs)("p",{children:[Object(r.jsx)("h3",{children:"Plate Number:"}),e.info.plateNumber]}),Object(r.jsxs)("p",{children:[Object(r.jsx)("h3",{children:"Jeep Capacity:"}),e.info.jeepCapacity]}),Object(r.jsx)("h3",{children:"Uploaded Images: "}),Object(r.jsx)(g.a,{className:"shadow-sm",children:_.map((function(e,a){return Object(r.jsx)(o.a,{md:{span:6},children:Object(r.jsxs)(i.a,{children:[Object(r.jsx)(y.a,{height:100,src:"/api/v1/images/".concat(e.imagePath?e.imagePath:"logo.png"),style:{borderColor:"white",border:"10px"}}),Object(r.jsx)(x.a,{onClick:function(){return a=e.id,void O.a.delete("/api/v1/images/delete_image",{params:{id:a,referenceId:1}}).then((function(e){var t=Object(C.a)(_);t=t.filter((function(e){return e.id!==a})),B(t),v.a.success({content:"Barangay image has been removed"})})).catch((function(e){return console.log(e)}));var a},danger:!0,children:"Delete"})]})},a)}))})]})]})},S=(t(415),t(414)),N=(t(144),t(48)),k=(t(412),t(409)),J=t(395);var w=function(e){var a=Object(d.useState)(!1),t=Object(b.a)(a,2),n=t[0],c=t[1],i=Object(d.useState)(!1),o=Object(b.a)(i,2),s=o[0],l=o[1],u=Object(d.useState)(!1),f=Object(b.a)(u,2),p=f[0],h=f[1],m=Object(d.useState)([]),g=Object(b.a)(m,2),y=g[0],I=g[1],w=Object(d.useState)({}),P=Object(b.a)(w,2),_=P[0],B=(P[1],Object(d.useState)("Choose file")),F=Object(b.a)(B,2),A=(F[0],F[1]),D=Object(d.useState)(),T=Object(b.a)(D,2),R=T[0],q=(T[1],Object(d.useState)([])),L=Object(b.a)(q,2),E=L[0],U=L[1];Object(d.useEffect)((function(){O.a.get("/api/v1/barangays/search_all_barangays").then((function(e){var a=e.data;U(a)})).catch((function(e){return console.log(e)}))}),[]);var V=k.a.Option,M=function(){h(!0),c(!1)},z=function(a){console.log(a),e.passedData(e.info),l(!0),h(!1),setTimeout((function(){c(!1),l(!1)}),2e3),O.a.post("/api/v1/jeepneys/add_jeep",a).then((function(e){var a=Object(C.a)(y);a=[].concat(Object(C.a)(a),[e.data]),console.log(a),I(a),v.a.success({content:"Successfully Added New Jeepney"}),O.a.post("/api/v1/images/save_image",{imageOwnerId:e.data.id,imageReferenceId:3,imagePath:R})})).catch((function(e){return console.log(e)}))};return Object(r.jsxs)("div",{children:[Object(r.jsx)(x.a,{type:"primary",onClick:function(){c(!0),console.log(e.info)},children:"Add Jeepney"}),Object(r.jsx)(v.a,{title:"Add Jeepney:",visible:n,confirmLoading:s,onOk:z,onCancel:M,afterClose:function(){p||e.afterClosing()},destroyOnClose:!0,footer:[Object(r.jsx)(x.a,{onClick:M,children:"Cancel"},"back"),Object(r.jsx)(x.a,{form:"myForm",htmlType:"submit",type:"primary",loading:s,onClick:z,children:"Add"},"submit")],children:Object(r.jsxs)(N.a,{layout:"vertical",name:"basic",initialValues:{remember:!0},onFinish:z,onFinishFailed:function(e){v.a.error({content:"Failure to Add New Jeepney"}),setTimeout((function(){c(!0),l(!1)}),2e3),console.log("fail"),console.log("Failed:",e)},id:"myForm",children:[Object(r.jsx)(N.a.Item,{label:"Barangay:",name:"barangayId",rules:[{required:!0,message:"Please input the Barangay's ID!"}],children:Object(r.jsx)(k.a,{placeholder:"Select Barangay",style:{width:"100%"},onChange:function(e){console.log("selected ".concat(e))},children:E.map((function(e,a){return Object(r.jsx)(V,{value:e.id,children:e.barangayName})}))})}),Object(r.jsx)(N.a.Item,{label:"Plate Number:",name:"plateNumber",rules:[{required:!0,message:"Please input the Plate Number!"}],children:Object(r.jsx)(j.a,{})}),Object(r.jsx)(N.a.Item,{label:"Jeep Capacity:",name:"jeepCapacity",rules:[{required:!0,message:"Please input the Jeep Capacity!"}],children:Object(r.jsx)(j.a,{})}),Object(r.jsx)(S.a,{action:"/api/v1/images/add_image",listType:"picture",maxCount:1,file:_,onChange:function(e){A(e)},children:Object(r.jsx)(x.a,{icon:Object(r.jsx)(J.a,{}),children:"Upload Image (Max: 1)"})})]})})]})};a.default=function(){var e=Object(d.useState)([]),a=Object(b.a)(e,2),t=a[0],u=a[1],f=j.a.Search,h=Object(d.useState)(""),g=Object(b.a)(h,2),y=g[0],x=g[1];Object(d.useEffect)((function(){O.a.get("/api/v1/jeepneys/").then((function(e){var a=e.data;a=a.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{barangayName:e.barangay.barangayName})})),u(a)})).catch((function(e){return console.log(e)}))}),[]);var v=function(){console.log("Passed data from modal",y),O.a.get("/api/v1/jeepneys/").then((function(e){var a=e.data;a=a.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{barangayName:e.barangay.barangayName})})),u(a)}))};return Object(r.jsxs)("div",{children:[Object(r.jsxs)(i.a,{justify:"space-between",children:[Object(r.jsx)(o.a,{span:4,children:Object(r.jsx)(s.b,{direction:"vertical",children:Object(r.jsx)(f,{placeholder:"Search Jeepney",onSearch:function(e){O.a.post("/api/v1/jeepneys/search_jeepneys",{value:e}).then((function(e){console.log(e);var a=e.data;a=a.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{barangayName:e.barangay.barangayName})})),u(a),console.log("success")})),console.log(e)},allowClear:!0,enterButton:!0})})}),Object(r.jsx)(o.a,{span:4,children:Object(r.jsx)(w,{info:"",passedData:x,afterClosing:v})})]}),Object(r.jsx)(c.a,{orientation:"center",children:"List of Jeepneys"}),Object(r.jsx)(i.a,{children:Object(r.jsxs)(n.a,{dataSource:t,scroll:{x:1e3,y:500},sticky:!0,children:[Object(r.jsx)(p.a,{title:"Barangay",dataIndex:"barangayName"},"barangayId"),Object(r.jsx)(m.a,{title:"Plate Number",dataIndex:"plateNumber"},"plateNumber"),Object(r.jsx)(m.a,{title:"Jeep Capacity",dataIndex:"jeepCapacity"},"jeepCapacity"),Object(r.jsx)(m.a,{title:"Actions",fixed:"right",render:function(e){return Object(r.jsx)(s.b,{children:Object(r.jsx)(I,{info:e,passedData:x,afterClosing:v})})}},"actions")]})})]})}}}]);
//# sourceMappingURL=8.11cf8286.chunk.js.map