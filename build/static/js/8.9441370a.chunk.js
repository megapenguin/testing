(this["webpackJsonpretrack-admin"]=this["webpackJsonpretrack-admin"]||[]).push([[8],{481:function(e,a,t){"use strict";t.r(a);t(410);var n=t(407),c=(t(402),t(404)),s=(t(124),t(58)),i=t(4),o=(t(126),t(43)),r=(t(400),t(401)),l=t(37),j=(t(125),t(59)),b=t(101),d=t(0),u=t(88),O=t.n(u),m=t(405),p=t.n(m),f=t(406),h=t.n(f),g=(t(145),t(103)),y=(t(209),t(146)),x=(t(100),t(64)),v=(t(398),t(399)),C=t(411),N=t(483);var I=function(e){var a=Object(d.useState)(!1),t=Object(b.a)(a,2),n=t[0],c=t[1],l=Object(d.useState)(!1),j=Object(b.a)(l,2),u=j[0],m=j[1],p=Object(d.useState)(!1),f=Object(b.a)(p,2),h=f[0],I=f[1],S=Object(d.useState)([]),w=Object(b.a)(S,2),k=w[0],J=w[1],P=Object(d.useState)([]),F=Object(b.a)(P,2),_=F[0],T=F[1],B=Object(d.useState)([]),R=Object(b.a)(B,2);return R[0],R[1],Object(i.jsxs)("div",{children:[Object(i.jsx)(r.b,{children:Object(i.jsxs)(x.a,{type:"primary",className:"modal-button",onClick:function(){c(!0),O.a.post("/api/v1/images/search_images",{imageOwnerId:e.info.id,imageReferenceId:3}).then((function(e){var a=e.data;T(a)})).catch((function(e){return console.log(e)}))},children:[Object(i.jsxs)("span",{className:"desktop-view",children:[Object(i.jsx)(N.a,{})," View"]}),Object(i.jsx)("span",{className:"mobile-view",children:Object(i.jsx)(N.a,{})})]})}),Object(i.jsxs)(v.a,{title:"Jeepney Information",visible:n,confirmLoading:u,onOk:function(){e.passedData(e.info),m(!0),I(!1),setTimeout((function(){c(!1),m(!1)}),2e3)},onCancel:function(){I(!0),c(!1)},afterClose:function(){h||e.afterClosing()},footer:[Object(i.jsx)(x.a,{className:"modal-button",loading:u,onClick:function(){return a=e.info.id,m(!0),I(!1),setTimeout((function(){c(!1),m(!1)}),2e3),O.a.delete("/api/v1/images/delete_image",{params:{id:a,referenceId:3}}).then((function(e){var t=Object(C.a)(_);t=t.filter((function(e){return e.imageOwnerId!==a&&3===e.imageReferenceId})),T(t),console.log(t)})).catch((function(e){return console.log(e)})),void O.a.delete("/api/v1/jeepneys/delete_jeep",{params:{id:a}}).then((function(e){var t=Object(C.a)(k);t=t.filter((function(e){return e.id!==a})),J(t),console.log(t),v.a.success({content:"Jeepney has been Removed"})})).catch((function(e){return console.log(e)}));var a},danger:!0,children:"Remove"})],children:[Object(i.jsxs)("p",{children:[Object(i.jsx)("h4",{children:"Barangay Id:"}),e.info.barangayId]}),Object(i.jsxs)("p",{children:[Object(i.jsx)("h4",{children:"Plate Number:"}),e.info.plateNumber]}),Object(i.jsxs)("p",{children:[Object(i.jsx)("h4",{children:"Jeep Capacity:"}),e.info.jeepCapacity]}),Object(i.jsx)("h4",{children:"Uploaded Images: "}),Object(i.jsx)(g.a,{className:"shadow-sm",children:Object(i.jsx)(s.a,{children:_.map((function(e,a){return Object(i.jsxs)(o.a,{md:{span:6},children:[Object(i.jsx)("br",{}),Object(i.jsx)(y.a,{height:100,width:100,src:"/api/v1/images/".concat(e.imagePath?e.imagePath:"logo.png")}),Object(i.jsxs)(s.a,{children:[Object(i.jsx)("br",{}),Object(i.jsx)(x.a,{onClick:function(){return a=e.id,void O.a.delete("/api/v1/images/delete_image",{params:{id:a,referenceId:1}}).then((function(e){var t=Object(C.a)(_);t=t.filter((function(e){return e.id!==a})),T(t),v.a.success({content:"Barangay image has been removed"})})).catch((function(e){return console.log(e)}));var a},danger:!0,children:"Delete"})]})]},a)}))})})]})]})},S=(t(412),t(409)),w=(t(144),t(48)),k=(t(414),t(408)),J=t(484),P=t(395);var F=function(e){var a=Object(d.useState)(!1),t=Object(b.a)(a,2),n=t[0],c=t[1],s=Object(d.useState)(!1),o=Object(b.a)(s,2),r=o[0],l=o[1],u=Object(d.useState)(!1),m=Object(b.a)(u,2),p=m[0],f=m[1],h=Object(d.useState)([]),g=Object(b.a)(h,2),y=g[0],N=g[1],I=Object(d.useState)({}),F=Object(b.a)(I,2),_=F[0],T=(F[1],Object(d.useState)("Choose file")),B=Object(b.a)(T,2),R=(B[0],B[1]),U=Object(d.useState)(),D=Object(b.a)(U,2),L=D[0],q=(D[1],Object(d.useState)([])),A=Object(b.a)(q,2),V=A[0],E=A[1];Object(d.useEffect)((function(){O.a.get("/api/v1/barangays/search_all_barangays").then((function(e){var a=e.data;E(a)})).catch((function(e){return console.log(e)}))}),[]);var z=k.a.Option,M=function(){f(!0),c(!1)},G=function(a){console.log(a),e.passedData(e.info),l(!0),f(!1),setTimeout((function(){c(!1),l(!1)}),2e3),O.a.post("/api/v1/jeepneys/add_jeep",a).then((function(e){var a=Object(C.a)(y);a=[].concat(Object(C.a)(a),[e.data]),console.log(a),N(a),v.a.success({content:"Successfully Added New Jeepney"}),O.a.post("/api/v1/images/save_image",{imageOwnerId:e.data.id,imageReferenceId:3,imagePath:L})})).catch((function(e){return console.log(e)}))};return Object(i.jsxs)("div",{children:[Object(i.jsxs)(x.a,{type:"primary",className:"modal-button-add",onClick:function(){c(!0),console.log(e.info)},children:[Object(i.jsxs)("span",{className:"desktop-view",children:[Object(i.jsx)(J.a,{})," Add Jeepney"]}),Object(i.jsx)("span",{className:"mobile-view",children:Object(i.jsx)(J.a,{})})]}),Object(i.jsx)(v.a,{title:"Add Jeepney:",visible:n,confirmLoading:r,onOk:G,onCancel:M,afterClose:function(){p||e.afterClosing()},destroyOnClose:!0,footer:[Object(i.jsx)(x.a,{className:"modal-button",onClick:M,children:"Cancel"},"back"),Object(i.jsx)(x.a,{form:"myForm",className:"modal-button",htmlType:"submit",type:"primary",loading:r,onClick:G,children:"Add"},"submit")],children:Object(i.jsxs)(w.a,{layout:"vertical",name:"basic",initialValues:{remember:!0},onFinish:G,onFinishFailed:function(e){v.a.error({content:"Failure to Add New Jeepney"}),setTimeout((function(){c(!0),l(!1)}),2e3),console.log("fail"),console.log("Failed:",e)},id:"myForm",children:[Object(i.jsx)(w.a.Item,{label:"Barangay:",name:"barangayId",rules:[{required:!0,message:"Please input the Barangay's ID!"}],children:Object(i.jsx)(k.a,{placeholder:"Select Barangay",style:{width:"100%"},onChange:function(e){console.log("selected ".concat(e))},children:V.map((function(e,a){return Object(i.jsx)(z,{value:e.id,children:e.barangayName})}))})}),Object(i.jsx)(w.a.Item,{label:"Plate Number:",name:"plateNumber",rules:[{required:!0,message:"Please input the Plate Number!"}],children:Object(i.jsx)(j.a,{})}),Object(i.jsx)(w.a.Item,{label:"Jeep Capacity:",name:"jeepCapacity",rules:[{required:!0,message:"Please input the Jeep Capacity!"}],children:Object(i.jsx)(j.a,{})}),Object(i.jsx)(S.a,{action:"/api/v1/images/add_image",listType:"picture",maxCount:1,file:_,onChange:function(e){R(e)},children:Object(i.jsx)(x.a,{icon:Object(i.jsx)(P.a,{}),children:"Upload Image (Max: 1)"})})]})})]})},_=t(485);var T=function(e){var a=Object(d.useState)(!1),t=Object(b.a)(a,2),n=t[0],c=t[1],s=w.a.useForm(),o=Object(b.a)(s,1)[0],r=Object(d.useState)(!1),l=Object(b.a)(r,2),u=l[0],m=l[1],p=Object(d.useState)(!1),f=Object(b.a)(p,2),h=f[0],g=f[1],y=Object(d.useState)(),C=Object(b.a)(y,2),N=C[0],I=C[1],S=Object(d.useState)([]),J=Object(b.a)(S,2),P=J[0],F=J[1];Object(d.useEffect)((function(){O.a.get("/api/v1/barangays/search_all_barangays").then((function(e){var a=e.data;F(a)})).catch((function(e){return console.log(e)}))}),[]);var T=k.a.Option,B=function(){g(!0),c(!1)},R=function(a){m(!0),g(!1),e.passedData(e.info),O.a.post("/api/v1/jeepneys/update_jeepney",{id:e.info.id,barangayId:a.barangayId,plateNumber:a.plateNumber,jeepCapacity:a.jeepCapacity}).then((function(e){setTimeout((function(){c(!1),m(!1)}),2e3),N?v.a.success({content:"Successfully Updated Jeepney"}):v.a.success({content:"Jeepney Info is up to date"})})).catch((function(e){return console.log(e)}))};return Object(i.jsxs)("div",{children:[Object(i.jsxs)(x.a,{type:"primary",className:"modal-button",onClick:function(){o.setFieldsValue({id:e.info.id,barangayId:e.info.barangayId,plateNumber:e.info.plateNumber,jeepCapacity:e.info.jeepCapacity}),c(!0),I(!1)},children:[Object(i.jsxs)("span",{className:"desktop-view",children:[Object(i.jsx)(_.a,{})," Edit"]}),Object(i.jsx)("span",{className:"mobile-view",children:Object(i.jsx)(_.a,{})})]}),Object(i.jsx)(v.a,{title:"Update Jeepney Info",confirmLoading:u,visible:n,onOk:R,onCancel:B,afterClose:function(){h||e.afterClosing()},destroyOnClose:!0,footer:[Object(i.jsx)(x.a,{className:"modal-button",onClick:B,children:"Cancel"},"back"),Object(i.jsx)(x.a,{form:"myForm",className:"modal-button",htmlType:"submit",type:"primary",children:"Update"})],children:Object(i.jsxs)(w.a,{layout:"vertical",name:"basic",form:o,initialValues:{remember:!0},onFinish:R,onFinishFailed:function(e){v.a.error({content:"Failure to Update Jeepney Info"}),setTimeout((function(){c(!0),m(!1)}),2e3)},onValuesChange:function(e,a){console.log("Changed",a,e),I(!0)},id:"myForm",children:[Object(i.jsx)(w.a.Item,{label:"Barangay:",name:"barangayId",rules:[{required:!0,message:"Please input the Barangay's ID!"}],children:Object(i.jsx)(k.a,{placeholder:"Select Barangay",style:{width:"100%"},onChange:function(e){console.log("selected ".concat(e))},children:P.map((function(e,a){return Object(i.jsx)(T,{value:e.id,children:e.barangayName})}))})}),Object(i.jsx)(w.a.Item,{label:"Plate Number:",name:"plateNumber",rules:[{required:!0,message:"Please input the Plate Number!"}],children:Object(i.jsx)(j.a,{})}),Object(i.jsx)(w.a.Item,{label:"Jeep Capacity:",name:"jeepCapacity",rules:[{required:!0,message:"Please input Jeep Capacity!"}],children:Object(i.jsx)(j.a,{})})]})})]})},B=(t(415),t(418)),R=(t(416),t(148));var U=function(e){var a=Object(d.useState)({}),t=Object(b.a)(a,2),n=(t[0],t[1],Object(d.useState)(!1)),c=Object(b.a)(n,2),o=(c[0],c[1],Object(d.useState)("Choose file")),j=Object(b.a)(o,2),u=(j[0],j[1]),m=Object(d.useState)(""),p=Object(b.a)(m,2),f=p[0],h=p[1],g=Object(d.useState)("none"),y=Object(b.a)(g,2),C=y[0],N=y[1],I=Object(d.useState)(""),k=Object(b.a)(I,2),J=(k[0],k[1],Object(d.useState)([])),F=Object(b.a)(J,2),_=(F[0],F[1],Object(d.useState)([])),T=Object(b.a)(_,2),U=(T[0],T[1],Object(d.useState)(!1)),D=Object(b.a)(U,2),L=(D[0],D[1]),q=Object(d.useState)(!1),A=Object(b.a)(q,2),V=A[0],E=A[1],z=w.a.useForm(),M=Object(b.a)(z,1)[0],G=Object(d.useState)(!1),H=Object(b.a)(G,2),K=H[0],Q=H[1],W=function(){L(!0),setTimeout((function(){E(!1),Q(!1)}),500)},X={name:"file",action:"/api/v1/images/add_image",headers:{authorization:"authorization-text"},data:{imageOwnerId:e.info.id,imageReferenceId:3},onChange:function(e){"uploading"!==e.file.status&&console.log("uploading",e.file,e.fileList),"done"===e.file.status?R.b.success("".concat(e.file.name," file uploaded Successfully.")):"error"===e.file.status&&R.b.error("".concat(e.file.name," file upload Failed.")),N(e.file.status),u(e)}};return Object(i.jsxs)("div",{children:[Object(i.jsxs)(x.a,{type:"primary",className:"modal-button",onClick:function(){M.setFieldsValue({imageOwnerId:e.info.id,imageReferenceId:3}),h(),N("removed"),u("Choose file"),E(!0),console.log(e.info)},children:[Object(i.jsxs)("span",{className:"desktop-view",children:[Object(i.jsx)(P.a,{})," Upload"]}),Object(i.jsx)("span",{className:"mobile-view",children:Object(i.jsx)(P.a,{})})]}),Object(i.jsxs)(v.a,{title:"Jeepney Image Upload",confirmLoading:K,visible:V,onOk:function(a){"done"==C?O.a.post("/api/v1/images/save_image",{imageOwnerId:e.info.id,imageReferenceId:3,imagePath:f}).then((function(e){R.b.success("Successfully Saved"),setTimeout((function(){E(!1),Q(!1)}),500),h("")})).catch((function(e){return console.log(e)})):R.b.error("Image Saving Error")},onCancel:W,afterClose:function(){Q(!0),L(!1)},destroyOnClose:!0,footer:[Object(i.jsx)(x.a,{className:"modal-button",type:"danger",onClick:W,children:"Close"},"back")],children:[Object(i.jsxs)(B.b,{itemLayout:"vertical",children:[Object(i.jsxs)(B.b.Item,{children:[Object(i.jsx)("h4",{children:"Plate Number: "}),e.info.plateNumber]}),Object(i.jsxs)(B.b.Item,{children:[Object(i.jsx)("h4",{children:"Image Reference Name: "}),"Jeepney"]})]}),Object(i.jsx)(s.a,{children:Object(i.jsx)(r.b,{style:{width:"100%"},size:"large",children:Object(i.jsx)(S.a,Object(l.a)(Object(l.a)({},X),{},{onRemove:function(e){O.a.delete("/api/v1/images/delete_folder_image",{params:{fileName:e.response.imagePath,fileId:e.response.id}}).then((function(e){N("removed")})).catch((function(e){return console.log(e)})),h(),R.b.error("File removed Successfully.")},listType:"picture-card",showUploadList:{showPreviewIcon:!1},maxCount:5,children:Object(i.jsxs)(r.b,{children:[Object(i.jsx)(P.a,{}),"Upload"]})}))})})]})]})};a.default=function(){var e=Object(d.useState)([]),a=Object(b.a)(e,2),t=a[0],u=a[1],m=j.a.Search,f=Object(d.useState)(""),g=Object(b.a)(f,2),y=g[0],x=g[1];Object(d.useEffect)((function(){O.a.get("/api/v1/jeepneys/").then((function(e){var a=e.data;a=a.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{barangayName:e.barangay.barangayName})})),u(a)})).catch((function(e){return console.log(e)}))}),[]);var v=function(){console.log("Passed data from modal",y),O.a.get("/api/v1/jeepneys/").then((function(e){var a=e.data;a=a.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{barangayName:e.barangay.barangayName})})),u(a)}))};return Object(i.jsxs)("div",{children:[Object(i.jsxs)(s.a,{justify:"space-between",children:[Object(i.jsx)(o.a,{span:4,children:Object(i.jsx)(r.b,{direction:"vertical",children:Object(i.jsx)(m,{placeholder:"Search Jeepney",onSearch:function(e){O.a.post("/api/v1/jeepneys/search_jeepneys",{value:e}).then((function(e){console.log(e);var a=e.data;a=a.map((function(e){return Object(l.a)(Object(l.a)({},e),{},{barangayName:e.barangay.barangayName})})),u(a),console.log("success")})),console.log(e)},allowClear:!0,enterButton:!0})})}),Object(i.jsx)(o.a,{span:4,children:Object(i.jsx)(F,{info:"",passedData:x,afterClosing:v})})]}),Object(i.jsx)(c.a,{orientation:"center",children:"List of Jeepneys"}),Object(i.jsx)(s.a,{children:Object(i.jsxs)(n.a,{dataSource:t,scroll:{x:1e3,y:500},sticky:!0,children:[Object(i.jsx)(p.a,{title:"Barangay",dataIndex:"barangayName"},"barangayId"),Object(i.jsx)(h.a,{title:"Plate Number",dataIndex:"plateNumber"},"plateNumber"),Object(i.jsx)(h.a,{title:"Jeep Capacity",dataIndex:"jeepCapacity"},"jeepCapacity"),Object(i.jsx)(h.a,{title:"Actions",fixed:"right",width:"35vh",render:function(e){return Object(i.jsxs)(r.b,{children:[Object(i.jsx)(I,{info:e,passedData:x,afterClosing:v}),Object(i.jsx)(T,{info:e,passedData:x,afterClosing:v}),Object(i.jsx)(U,{info:e})]})}},"actions")]})})]})}}}]);
//# sourceMappingURL=8.9441370a.chunk.js.map